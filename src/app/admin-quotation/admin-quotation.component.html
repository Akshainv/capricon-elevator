<!-- src/app/admin-quotation/admin-quotation.component.html -->
<div class="quotations-container">
    <!-- Page Header -->
    <div class="page-header">
        <div class="header-left">
            <h1>ðŸ“‹ My Quotations</h1>
            <p>View and manage your quotations</p>
        </div>
    </div>

    <!-- Search Section -->
    <div class="filters-section">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search by customer, quote number, email, company..."
                [(ngModel)]="searchTerm" (input)="applyFiltersAndSort()" />
        </div>

        <!-- Filter & Counts Section -->
        <div class="filter-controls">
            <!-- Filter Dropdown -->
            <div class="filter-group">
                <label>Filter Status:</label>
                <select [(ngModel)]="selectedFilter" (change)="applyFiltersAndSort()" class="filter-select">
                    <option value="Pending">Pending</option>
                    <option value="Approved">Approved</option>
                    <option value="Rejected">Rejected</option>
                </select>
            </div>

            <!-- Counts Summary -->
            <div class="counts-summary">
                <div class="count-badge badge-pending">
                    <span class="count-label">Pending</span>
                    <span class="count-value">{{ pendingCount }}</span>
                </div>
                <div class="count-badge badge-approved">
                    <span class="count-label">Approved</span>
                    <span class="count-value">{{ approvedCount }}</span>
                </div>
                <div class="count-badge badge-rejected">
                    <span class="count-label">Rejected</span>
                    <span class="count-value">{{ rejectedCount }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
        <p>Loading quotations...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-state">
        <p>{{ error }}</p>
    </div>

    <!-- Quotations Table -->
    <div class="table-card" *ngIf="!loading">
        <div class="table-container">
            <table class="quotations-table">
                <thead>
                    <tr>
                        <th>Quote #</th>
                        <th>Customer</th>
                        <th>Company</th>
                        <th>Quote Date</th>
                        <th>Valid Until</th>
                        <th>Elevator Type</th>
                        <th>Employee</th>
                        <th class="col-approval">Approval</th>
                        <th class="col-actions">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let quote of paginatedQuotations" class="table-row">
                        <td class="quote-number">{{ quote.quoteNumber }}</td>
                        <td>
                            <div class="customer-info">
                                <div class="customer-name">{{ quote.customerName || 'N/A' }}</div>
                                <div class="customer-contact">{{ quote.customerPhone || 'N/A' }}</div>
                            </div>
                        </td>
                        <td>
                            <div class="company-info">{{ quote.customerCompany || quote.companyName || 'N/A' }}</div>
                        </td>
                        <td>
                            <div class="date-info">{{ formatDate(quote.quoteDate) }}</div>
                        </td>
                        <td>
                            <div class="date-info">{{ formatDate(quote.validUntil) }}</div>
                        </td>
                        <td>
                            <div class="elevator-info">
                                <span class="elevator-icon">{{ getElevatorTypeIcon(quote.elevationType) }}</span>
                                {{ quote.elevationType || 'N/A' }}
                            </div>
                        </td>
                        <td>
                            <div class="employee-info">{{ quote.createdBy || 'N/A' }}</div>
                        </td>
                        <td class="col-approval">
                            <!-- Approval Actions -->
                            <div class="approval-actions">
                                <button class="approval-btn btn-approve"
                                    [class.active]="$any(quote).status === 'Approved'"
                                    [disabled]="$any(quote).status === 'Approved'"
                                    (click)="updateStatus(quote, 'Approved')" title="Approve">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="approval-btn btn-reject"
                                    [class.active]="$any(quote).status === 'Rejected'"
                                    [disabled]="$any(quote).status === 'Rejected'"
                                    (click)="updateStatus(quote, 'Rejected')" title="Reject">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </td>
                        <td class="col-actions">
                            <div class="action-buttons">
                                <button class="action-btn btn-view" (click)="viewQuotation(getQuotationId(quote))"
                                    title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="action-btn btn-delete" (click)="deleteQuotation(getQuotationId(quote))"
                                    title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- Empty State -->
            <div *ngIf="filteredQuotations.length === 0 && !loading" class="empty-state">
                <i class="fas fa-file-invoice"></i>
                <h3>No quotations found</h3>
            </div>
        </div>

        <!-- Pagination -->
        <div class="pagination-controls" *ngIf="filteredQuotations.length > 0">
            <button class="pagination-btn" (click)="prevPage()" [disabled]="currentPage === 1">
                <i class="fas fa-chevron-left"></i>
            </button>
            <span class="page-info">Page {{ currentPage }} of {{ totalPages }}</span>
            <button class="pagination-btn" (click)="nextPage()" [disabled]="currentPage >= totalPages">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
</div>